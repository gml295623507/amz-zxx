{"remainingRequest":"/Users/95h/95h-Projects/security-enterprise-2.4.0/security-enterprise-admin/node_modules/babel-loader/lib/index.js!/Users/95h/95h-Projects/security-enterprise-2.4.0/security-enterprise-admin/node_modules/eslint-loader/index.js??ref--13-0!/Users/95h/95h-Projects/security-enterprise-2.4.0/security-enterprise-admin/src/router/index.js","dependencies":[{"path":"/Users/95h/95h-Projects/security-enterprise-2.4.0/security-enterprise-admin/src/router/index.js","mtime":1594281632857},{"path":"/Users/95h/95h-Projects/security-enterprise-2.4.0/security-enterprise-admin/node_modules/cache-loader/dist/cjs.js","mtime":1593769583426},{"path":"/Users/95h/95h-Projects/security-enterprise-2.4.0/security-enterprise-admin/node_modules/babel-loader/lib/index.js","mtime":1593769580300},{"path":"/Users/95h/95h-Projects/security-enterprise-2.4.0/security-enterprise-admin/node_modules/eslint-loader/index.js","mtime":1593769582427}],"contextDependencies":[],"result":["import \"core-js/modules/es7.object.get-own-property-descriptors\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.object.keys\";\nimport _defineProperty from \"/Users/95h/95h-Projects/security-enterprise-2.4.0/security-enterprise-admin/node_modules/@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es6.regexp.replace\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport Vue from 'vue';\nimport Router from 'vue-router';\nimport http from '@/utils/request';\nimport { isURL } from '@/utils/validate';\nVue.use(Router); // 页面路由(独立页面)\n\nexport var pageRoutes = [{\n  path: '/404',\n  component: function component() {\n    return import('@/views/pages/404');\n  },\n  name: '404',\n  meta: {\n    title: '404未找到'\n  },\n  beforeEnter: function beforeEnter(to, from, next) {\n    // 拦截处理特殊业务场景\n    // 如果, 重定向路由包含__双下划线, 为临时添加路由\n    if (/__.*/.test(to.redirectedFrom)) {\n      return next(to.redirectedFrom.replace(/__.*/, ''));\n    }\n\n    next();\n  }\n}, {\n  path: '/login',\n  component: function component() {\n    return import('@/views/pages/login');\n  },\n  name: 'login',\n  meta: {\n    title: '登录'\n  }\n}, {\n  path: '/register',\n  component: function component() {\n    return import('@/views/pages/register');\n  },\n  name: 'register',\n  meta: {\n    title: '注册'\n  }\n}]; // 模块路由(基于主入口布局页面)\n\nexport var moduleRoutes = {\n  path: '/',\n  component: function component() {\n    return import('@/views/main');\n  },\n  name: 'main',\n  redirect: {\n    name: 'home'\n  },\n  meta: {\n    title: '主入口布局'\n  },\n  children: [{\n    path: '/home',\n    component: function component() {\n      return import('@/views/modules/home');\n    },\n    name: 'home',\n    meta: {\n      title: '首页',\n      isTab: true\n    }\n  }]\n};\nexport function addDynamicRoute(routeParams, router) {\n  // 组装路由名称, 并判断是否已添加, 如是: 则直接跳转\n  var routeName = routeParams.routeName;\n  var dynamicRoute = window.SITE_CONFIG['dynamicRoutes'].filter(function (item) {\n    return item.name === routeName;\n  })[0];\n\n  if (dynamicRoute) {\n    return router.push({\n      name: routeName,\n      params: routeParams.params\n    });\n  } // 否则: 添加并全局变量保存, 再跳转\n\n\n  dynamicRoute = {\n    path: routeName,\n    component: function component() {\n      return import(\"@/views/modules/\".concat(routeParams.path));\n    },\n    name: routeName,\n    meta: _objectSpread(_objectSpread({}, window.SITE_CONFIG['contentTabDefault']), {}, {\n      menuId: routeParams.menuId,\n      title: \"\".concat(routeParams.title)\n    })\n  };\n  router.addRoutes([_objectSpread(_objectSpread({}, moduleRoutes), {}, {\n    name: \"main-dynamic__\".concat(dynamicRoute.name),\n    children: [dynamicRoute]\n  })]);\n  window.SITE_CONFIG['dynamicRoutes'].push(dynamicRoute);\n  router.push({\n    name: dynamicRoute.name,\n    params: routeParams.params\n  });\n}\nvar router = new Router({\n  mode: 'hash',\n  scrollBehavior: function scrollBehavior() {\n    return {\n      y: 0\n    };\n  },\n  routes: pageRoutes.concat(moduleRoutes)\n});\nrouter.beforeEach(function (to, from, next) {\n  // 添加动态(菜单)路由\n  // 已添加或者当前路由为页面路由, 可直接访问\n  if (window.SITE_CONFIG['dynamicMenuRoutesHasAdded'] || fnCurrentRouteIsPageRoute(to, pageRoutes)) {\n    return next();\n  } // 获取字典列表, 添加并全局变量保存\n\n\n  http.get('/sys/dict/type/all').then(function (_ref) {\n    var res = _ref.data;\n\n    if (res.code !== 0) {\n      return;\n    }\n\n    window.SITE_CONFIG['dictList'] = res.data;\n  }).catch(function () {}); // 获取菜单列表, 添加并全局变量保存\n\n  http.get('/sys/menu/nav').then(function (_ref2) {\n    var res = _ref2.data;\n\n    if (res.code !== 0) {\n      Vue.prototype.$message.error(res.msg);\n      return next({\n        name: 'login'\n      });\n    }\n\n    window.SITE_CONFIG['menuList'] = res.data;\n    fnAddDynamicMenuRoutes(window.SITE_CONFIG['menuList']);\n    next(_objectSpread(_objectSpread({}, to), {}, {\n      replace: true\n    }));\n  }).catch(function () {\n    next({\n      name: 'login'\n    });\n  });\n});\n/**\r\n * 判断当前路由是否为页面路由\r\n * @param {*} route 当前路由\r\n * @param {*} pageRoutes 页面路由\r\n */\n\nfunction fnCurrentRouteIsPageRoute(route) {\n  var pageRoutes = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  var temp = [];\n\n  for (var i = 0; i < pageRoutes.length; i++) {\n    if (route.path === pageRoutes[i].path) {\n      return true;\n    }\n\n    if (pageRoutes[i].children && pageRoutes[i].children.length >= 1) {\n      temp = temp.concat(pageRoutes[i].children);\n    }\n  }\n\n  return temp.length >= 1 ? fnCurrentRouteIsPageRoute(route, temp) : false;\n}\n/**\r\n * 添加动态(菜单)路由\r\n * @param {*} menuList 菜单列表\r\n * @param {*} routes 递归创建的动态(菜单)路由\r\n */\n\n\nfunction fnAddDynamicMenuRoutes() {\n  var menuList = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n  var routes = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  var temp = [];\n\n  var _loop = function _loop() {\n    if (menuList[i].children && menuList[i].children.length >= 1) {\n      temp = temp.concat(menuList[i].children);\n      return \"continue\";\n    } // 组装路由\n\n\n    route = {\n      path: '',\n      component: null,\n      name: '',\n      meta: _objectSpread(_objectSpread({}, window.SITE_CONFIG['contentTabDefault']), {}, {\n        menuId: menuList[i].id,\n        title: menuList[i].name\n      })\n    }; // eslint-disable-next-line\n\n    var URL = (menuList[i].url || '').replace(/{{([^}}]+)?}}/g, function (s1, s2) {\n      return eval(s2);\n    }); // URL支持{{ window.xxx }}占位符变量\n\n    if (isURL(URL)) {\n      route['path'] = route['name'] = \"i-\".concat(menuList[i].id);\n      route['meta']['iframeURL'] = URL;\n    } else {\n      URL = URL.replace(/^\\//, '').replace(/_/g, '-');\n      route['path'] = route['name'] = URL.replace(/\\//g, '-');\n\n      route['component'] = function () {\n        return import(\"@/views/modules/\".concat(URL));\n      };\n    }\n\n    routes.push(route);\n  };\n\n  for (var i = 0; i < menuList.length; i++) {\n    var route;\n\n    var _ret = _loop();\n\n    if (_ret === \"continue\") continue;\n  }\n\n  if (temp.length >= 1) {\n    return fnAddDynamicMenuRoutes(temp, routes);\n  } // 添加路由\n\n\n  router.addRoutes([_objectSpread(_objectSpread({}, moduleRoutes), {}, {\n    name: 'main-dynamic-menu',\n    children: routes\n  }), {\n    path: '*',\n    redirect: {\n      name: '404'\n    }\n  }]);\n  window.SITE_CONFIG['dynamicMenuRoutes'] = routes;\n  window.SITE_CONFIG['dynamicMenuRoutesHasAdded'] = true;\n}\n\nexport default router;",{"version":3,"sources":["/Users/95h/95h-Projects/security-enterprise-2.4.0/security-enterprise-admin/src/router/index.js"],"names":["Vue","Router","http","isURL","use","pageRoutes","path","component","name","meta","title","beforeEnter","to","from","next","test","redirectedFrom","replace","moduleRoutes","redirect","children","isTab","addDynamicRoute","routeParams","router","routeName","dynamicRoute","window","SITE_CONFIG","filter","item","push","params","menuId","addRoutes","mode","scrollBehavior","y","routes","concat","beforeEach","fnCurrentRouteIsPageRoute","get","then","res","data","code","catch","prototype","$message","error","msg","fnAddDynamicMenuRoutes","route","temp","i","length","menuList","id","URL","url","s1","s2","eval"],"mappings":"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","sourcesContent":["import Vue from 'vue'\r\nimport Router from 'vue-router'\r\nimport http from '@/utils/request'\r\nimport { isURL } from '@/utils/validate'\r\n\r\nVue.use(Router)\r\n\r\n// 页面路由(独立页面)\r\nexport const pageRoutes = [\r\n  {\r\n    path: '/404',\r\n    component: () => import('@/views/pages/404'),\r\n    name: '404',\r\n    meta: { title: '404未找到' },\r\n    beforeEnter (to, from, next) {\r\n      // 拦截处理特殊业务场景\r\n      // 如果, 重定向路由包含__双下划线, 为临时添加路由\r\n      if (/__.*/.test(to.redirectedFrom)) {\r\n        return next(to.redirectedFrom.replace(/__.*/, ''))\r\n      }\r\n      next()\r\n    }\r\n  },\r\n  { path: '/login', component: () => import('@/views/pages/login'), name: 'login', meta: { title: '登录' } },\r\n  { path: '/register', component: () => import('@/views/pages/register'), name: 'register', meta: { title: '注册' } }\r\n]\r\n\r\n// 模块路由(基于主入口布局页面)\r\nexport const moduleRoutes = {\r\n  path: '/',\r\n  component: () => import('@/views/main'),\r\n  name: 'main',\r\n  redirect: { name: 'home' },\r\n  meta: { title: '主入口布局' },\r\n  children: [\r\n    { path: '/home', component: () => import('@/views/modules/home'), name: 'home', meta: { title: '首页', isTab: true } }\r\n  ]\r\n}\r\n\r\nexport function addDynamicRoute (routeParams, router) {\r\n  // 组装路由名称, 并判断是否已添加, 如是: 则直接跳转\r\n  var routeName = routeParams.routeName\r\n  var dynamicRoute = window.SITE_CONFIG['dynamicRoutes'].filter(item => item.name === routeName)[0]\r\n  if (dynamicRoute) {\r\n    return router.push({ name: routeName, params: routeParams.params })\r\n  }\r\n  // 否则: 添加并全局变量保存, 再跳转\r\n  dynamicRoute = {\r\n    path: routeName,\r\n    component: () => import(`@/views/modules/${routeParams.path}`),\r\n    name: routeName,\r\n    meta: {\r\n      ...window.SITE_CONFIG['contentTabDefault'],\r\n      menuId: routeParams.menuId,\r\n      title: `${routeParams.title}`\r\n    }\r\n  }\r\n  router.addRoutes([\r\n    {\r\n      ...moduleRoutes,\r\n      name: `main-dynamic__${dynamicRoute.name}`,\r\n      children: [dynamicRoute]\r\n    }\r\n  ])\r\n  window.SITE_CONFIG['dynamicRoutes'].push(dynamicRoute)\r\n  router.push({ name: dynamicRoute.name, params: routeParams.params })\r\n}\r\n\r\nconst router = new Router({\r\n  mode: 'hash',\r\n  scrollBehavior: () => ({ y: 0 }),\r\n  routes: pageRoutes.concat(moduleRoutes)\r\n})\r\n\r\nrouter.beforeEach((to, from, next) => {\r\n  // 添加动态(菜单)路由\r\n  // 已添加或者当前路由为页面路由, 可直接访问\r\n  if (window.SITE_CONFIG['dynamicMenuRoutesHasAdded'] || fnCurrentRouteIsPageRoute(to, pageRoutes)) {\r\n    return next()\r\n  }\r\n  // 获取字典列表, 添加并全局变量保存\r\n  http.get('/sys/dict/type/all').then(({ data: res }) => {\r\n    if (res.code !== 0) {\r\n      return\r\n    }\r\n    window.SITE_CONFIG['dictList'] = res.data\r\n  }).catch(() => {})\r\n  // 获取菜单列表, 添加并全局变量保存\r\n  http.get('/sys/menu/nav').then(({ data: res }) => {\r\n    if (res.code !== 0) {\r\n      Vue.prototype.$message.error(res.msg)\r\n      return next({ name: 'login' })\r\n    }\r\n    window.SITE_CONFIG['menuList'] = res.data\r\n    fnAddDynamicMenuRoutes(window.SITE_CONFIG['menuList'])\r\n    next({ ...to, replace: true })\r\n  }).catch(() => {\r\n    next({ name: 'login' })\r\n  })\r\n})\r\n\r\n/**\r\n * 判断当前路由是否为页面路由\r\n * @param {*} route 当前路由\r\n * @param {*} pageRoutes 页面路由\r\n */\r\nfunction fnCurrentRouteIsPageRoute (route, pageRoutes = []) {\r\n  var temp = []\r\n  for (var i = 0; i < pageRoutes.length; i++) {\r\n    if (route.path === pageRoutes[i].path) {\r\n      return true\r\n    }\r\n    if (pageRoutes[i].children && pageRoutes[i].children.length >= 1) {\r\n      temp = temp.concat(pageRoutes[i].children)\r\n    }\r\n  }\r\n  return temp.length >= 1 ? fnCurrentRouteIsPageRoute(route, temp) : false\r\n}\r\n\r\n/**\r\n * 添加动态(菜单)路由\r\n * @param {*} menuList 菜单列表\r\n * @param {*} routes 递归创建的动态(菜单)路由\r\n */\r\nfunction fnAddDynamicMenuRoutes (menuList = [], routes = []) {\r\n  var temp = []\r\n  for (var i = 0; i < menuList.length; i++) {\r\n    if (menuList[i].children && menuList[i].children.length >= 1) {\r\n      temp = temp.concat(menuList[i].children)\r\n      continue\r\n    }\r\n    // 组装路由\r\n    var route = {\r\n      path: '',\r\n      component: null,\r\n      name: '',\r\n      meta: {\r\n        ...window.SITE_CONFIG['contentTabDefault'],\r\n        menuId: menuList[i].id,\r\n        title: menuList[i].name\r\n      }\r\n    }\r\n    // eslint-disable-next-line\r\n    let URL = (menuList[i].url || '').replace(/{{([^}}]+)?}}/g, (s1, s2) => eval(s2)) // URL支持{{ window.xxx }}占位符变量\r\n    if (isURL(URL)) {\r\n      route['path'] = route['name'] = `i-${menuList[i].id}`\r\n      route['meta']['iframeURL'] = URL\r\n    } else {\r\n      URL = URL.replace(/^\\//, '').replace(/_/g, '-')\r\n      route['path'] = route['name'] = URL.replace(/\\//g, '-')\r\n      route['component'] = () => import(`@/views/modules/${URL}`)\r\n    }\r\n    routes.push(route)\r\n  }\r\n  if (temp.length >= 1) {\r\n    return fnAddDynamicMenuRoutes(temp, routes)\r\n  }\r\n  // 添加路由\r\n  router.addRoutes([\r\n    {\r\n      ...moduleRoutes,\r\n      name: 'main-dynamic-menu',\r\n      children: routes\r\n    },\r\n    { path: '*', redirect: { name: '404' } }\r\n  ])\r\n  window.SITE_CONFIG['dynamicMenuRoutes'] = routes\r\n  window.SITE_CONFIG['dynamicMenuRoutesHasAdded'] = true\r\n}\r\n\r\nexport default router\r\n"]}]}